<Page x:Class="ComputerClub.Navigation.ClientRegistrationPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:local="clr-namespace:ComputerClub"
      x:Name="thisPage">

    <!-- Локальные ресурсы ТОЛЬКО для этой страницы -->
    <Page.Resources>
        <!-- Базовый стиль — общие свойства для обоих глазиков -->
        <Style x:Key="PasswordToggleButtonBase" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Foreground" Value="#AAAAAA"/>
            <Setter Property="FontSize" Value="20"/>
            <Setter Property="FontFamily" Value="Segoe UI Symbol"/>
            <Setter Property="Width" Value="48"/>
            <Setter Property="Height" Value="48"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="VerticalAlignment" Value="Top"/>
            <Setter Property="HorizontalAlignment" Value="Right"/>
            <Setter Property="Margin" Value="0,0,8,0"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="Content" Value="👁"/>
            <!-- по умолчанию — открытый глаз -->
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="4">
                            <ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <!-- общие hover / pressed -->
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Foreground" Value="{StaticResource AccentYellow}"/>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Foreground" Value="{StaticResource AccentYellowPressed}"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Стиль для ПЕРВОГО поля (основной пароль) -->
        <Style x:Key="PasswordToggleButtonMain" 
               TargetType="Button" 
               BasedOn="{StaticResource PasswordToggleButtonBase}">
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsMainPasswordVisible, ElementName=thisPage}" Value="True">
                    <Setter Property="Content" Value="✗"/>
                    <!-- зачёркнутый глаз / скрыт -->
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <!-- Стиль для ВТОРОГО поля (повтор пароля) -->
        <Style x:Key="PasswordToggleButtonConfirm" 
               TargetType="Button" 
               BasedOn="{StaticResource PasswordToggleButtonBase}">
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsConfirmPasswordVisible, ElementName=thisPage}" Value="True">
                    <Setter Property="Content" Value="✗"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </Page.Resources>

    <Grid Margin="40">
        <ScrollViewer VerticalScrollBarVisibility="Auto">
            <StackPanel Width="400" VerticalAlignment="Center" HorizontalAlignment="Center">
                <TextBlock Text="Регистрация клиента"
                           FontSize="26" FontWeight="SemiBold"
                           Foreground="{StaticResource AccentYellow}"
                           HorizontalAlignment="Center" Margin="0,0,0,30"/>
                <TextBlock Text="ФИО" Style="{StaticResource FieldLabel}"/>
                <TextBox x:Name="tbFullName" />
                <TextBlock Text="Номер телефона" Style="{StaticResource FieldLabel}"/>
                <TextBox x:Name="tbPhone"
                         Text="+7"
                         MaxLength="18"
                         PreviewTextInput="Phone_PreviewTextInput"
                         TextChanged="Phone_TextChanged"/>
                <TextBlock Text="Пол" Style="{StaticResource FieldLabel}"/>
                <StackPanel Orientation="Horizontal" Margin="0,8,0,16">
                    <RadioButton x:Name="rbMale" Content="Мужской" Margin="0,0,30,0" GroupName="Gender" Style="{StaticResource GenderRadioButton}"/>
                    <RadioButton x:Name="rbFemale" Content="Женский" Margin="0,0,30,0" GroupName="Gender" Style="{StaticResource GenderRadioButton}"/>
                </StackPanel>
                <TextBlock Text="Email (необязательно)" Style="{StaticResource FieldLabel}"/>
                <TextBox x:Name="tbEmail" />
                <TextBlock Text="Пароль" Style="{StaticResource FieldLabel}"/>
                <Grid>
                    <PasswordBox x:Name="pbPassword"
                                 Style="{StaticResource DarkInput}"
                                 Padding="12,10,48,10"
                                 Visibility="Visible"/>
                    <TextBox x:Name="tbPassword"
                             Style="{StaticResource DarkInput}"
                             Padding="12,10,48,10"
                             Visibility="Collapsed"/>
                    <Button x:Name="btnTogglePassword1"
                            Style="{StaticResource PasswordToggleButtonMain}"
                            Click="TogglePassword1_Click"/>
                </Grid>
                <TextBlock Text="Повторите пароль" Style="{StaticResource FieldLabel}"/>
                <Grid>
                    <PasswordBox x:Name="pbConfirmPassword"
                                 Style="{StaticResource DarkInput}"
                                 Padding="12,10,48,10"
                                 Visibility="Visible"/>
                    <TextBox x:Name="tbConfirmPassword"
                             Style="{StaticResource DarkInput}"
                             Padding="12,10,48,10"
                             Visibility="Collapsed"/>
                    <Button x:Name="btnTogglePassword2"
                            Style="{StaticResource PasswordToggleButtonConfirm}"
                            Click="TogglePassword2_Click"/>
                </Grid>
                <Button Content="ЗАРЕГИСТРИРОВАТЬСЯ"
                        Style="{StaticResource YellowActionButton}"
                        Margin="0,24,0,16"
                        Click="RegisterButton_Click"/>
                <TextBlock Text="Уже зарегистрированы? Войти"
                           Style="{StaticResource LinkStyle}"
                           HorizontalAlignment="Center"
                           MouseLeftButtonDown="LoginLink_MouseDown"/>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</Page>